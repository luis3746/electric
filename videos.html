<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Galería de YouTube</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .video-thumb img {
            width: 100%;
            height: 230px;
            object-fit: cover;
        }
        .video-thumb {
            position: relative;
        }
        .play-btn {
            position: absolute;
            left: 50%; top: 50%;
            transform: translate(-50%,-50%);
            font-size: 48px;
            color: white;
            text-shadow: 0 0 8px black;
            pointer-events: none;
        }
    </style>
</head>
<body>
<div class="container py-4">
  <h2 class="mb-4">Galería de YouTube</h2>
  <div id="gallery" class="row g-3"></div>
  <nav>
    <ul id="pagination" class="pagination justify-content-center my-4"></ul>
  </nav>
</div>

<script>
// Pega aquí tus links de prueba si no funciona el fetch:
let videos = [
  "https://www.youtube.com/watch?v=wlGgTxg2lAg",
  "https://youtu.be/82jgT6DLN44",
  "https://www.youtube.com/watch?v=iiE0IpwxM0g&ab_channel=MyChannel"
];

// -- Si puedes, usa fetch para cargar un archivo txt público --
// const TXT_FILE_URL = "https://tu-url-publica-del-txt";

// async function loadVideoLinks(url) {
//     try {
//         const resp = await fetch(url);
//         const text = await resp.text();
//         return text.split('\n').map(l => l.trim()).filter(l => l.length > 5);
//     } catch(e) {
//         // Si falla fetch, usa el array videos
//         return videos;
//     }
// }

function getYouTubeID(url) {
    let m = url.match(/v=([^&]+)/);
    if (m) return m[1];
    m = url.match(/youtu\.be\/([^\?&]+)/);
    return m ? m[1] : null;
}

function renderGallery(videoLinks, page, perPage) {
    const gallery = document.getElementById('gallery');
    gallery.innerHTML = '';
    const start = (page-1)*perPage;
    const end = Math.min(start+perPage, videoLinks.length);
    for (let i = start; i < end; i++) {
        const videoID = getYouTubeID(videoLinks[i]);
        if(!videoID) continue;
        const thumb = `https://img.youtube.com/vi/${videoID}/hqdefault.jpg`;
        gallery.innerHTML += `
        <div class="col-12 col-md-4">
          <div class="card">
            <a href="https://www.youtube.com/watch?v=${videoID}" target="_blank" class="video-thumb">
              <img src="${thumb}" alt="Miniatura video" class="card-img-top">
              <span class="play-btn">▶</span>
            </a>
            <div class="card-body p-2 text-center">
              <a href="https://www.youtube.com/watch?v=${videoID}" target="_blank">Ver en YouTube</a>
            </div>
          </div>
        </div>`;
    }
}

function renderPagination(videoLinks, perPage, page, onPageClick) {
    const pagination = document.getElementById('pagination');
    const total = Math.ceil(videoLinks.length / perPage);
    pagination.innerHTML = '';
    for (let i = 1; i <= total; i++) {
        pagination.innerHTML += `<li class="page-item${i === page ? ' active' : ''}">
            <a class="page-link" href="#">${i}</a>
        </li>`;
    }
    pagination.querySelectorAll('.page-link').forEach((el, idx) => {
        el.addEventListener('click', e => {
            e.preventDefault();
            onPageClick(idx+1);
        });
    });
}

const PER_PAGE = 6;
let currentPage = 1;

window.addEventListener('DOMContentLoaded', async () => {
    // let loadedVideos = await loadVideoLinks('https://raw.githubusercontent.com/luis3746/electric/refs/heads/main/videos_subidos.txt'); // Solo si fetch es posible
    let loadedVideos = videos;
    const renderAll = p => {
        currentPage = p;
        renderGallery(loadedVideos, p, PER_PAGE);
        renderPagination(loadedVideos, PER_PAGE, p, renderAll);
    };
    renderAll(1);
});
</script>
</body>
</html>
